drop table calendar;

create table calendar as
(
SELECT
"public"."TBL_ACTIVITY"."ACTIVITYID",
"public"."TBL_ACTIVITYTYPE"."NAME",
"public"."TBL_ACTIVITY"."REGARDING",
"public"."TBL_ACTIVITY"."DETAILS",
extract(epoch from "STARTTIME") as starttime,
extract(epoch from "ENDTIME") as endtime,
"public"."TBL_ACTIVITY"."DURATION",
"public"."TBL_ACTIVITY"."ORIGINALTIME",
"public"."TBL_ACTIVITY"."ISTIMELESS",
"public"."TBL_ACTIVITY"."LOCATION",
--"public"."TBL_ACTIVITY"."RECURPERIOD",
--"public"."TBL_ACTIVITY"."RECURMONTH",
--"public"."TBL_ACTIVITY"."RECURENDDATE",
--"public"."TBL_ACTIVITY"."ISRECURENDLESS",
--"public"."TBL_ACTIVITY"."RECURDAYTYPE",
case when "public"."TBL_ACTIVITY"."CREATEUSERID" = '{EB238265-9A3B-4B52-AE0B-157BCA86FEA9}' then '39'
	when "public"."TBL_ACTIVITY"."CREATEUSERID" = '{F12D6456-832D-479F-A7C8-F3EB8C5B722E}' then '47'
	when "public"."TBL_ACTIVITY"."CREATEUSERID" = '{DB68D259-ACBC-4B4E-BD93-DA6EDAD9B884}' then '36'
	when "public"."TBL_ACTIVITY"."CREATEUSERID" = '{9C9297BA-273C-4E8E-BE2F-4FC92054C414}' then '45'
	when "public"."TBL_ACTIVITY"."CREATEUSERID" = '{73CCB30F-77B0-41DB-BF4E-7212134D4073}' then '51'
	when "public"."TBL_ACTIVITY"."CREATEUSERID" = '{D2F7587B-4533-4347-BC26-E93FB94B7F8E}' then '49'
	when "public"."TBL_ACTIVITY"."CREATEUSERID" = '{BCB8E2B4-D4DB-43D0-A7E7-3A013852BEE3}' then '35'
	when "public"."TBL_ACTIVITY"."CREATEUSERID" = '{E1DF9B2A-AC53-490D-86B0-2FA5ACE2D19F}' then '46'
	when "public"."TBL_ACTIVITY"."CREATEUSERID" = '{C79982B1-19DA-4ED5-9182-ACEDF6AEE393}' then '37'
	when "public"."TBL_ACTIVITY"."CREATEUSERID" = '{8BA6FC42-4A1B-424F-8167-9AEED8911491}' then '40'
	when "public"."TBL_ACTIVITY"."CREATEUSERID" = '{16D4DC0F-40FF-4B1B-A148-11E02AB09DAC}' then '48'
	when "public"."TBL_ACTIVITY"."CREATEUSERID" = '{ADECC1D0-5798-450B-AFAF-C6CFD0025FBD}' then '41'
	when "public"."TBL_ACTIVITY"."CREATEUSERID" = '{191D3EC9-9DA0-4F2D-AC87-C41F79471E74}' then '52'
	when "public"."TBL_ACTIVITY"."CREATEUSERID" = '{11F93965-FF8A-43AE-981C-16053273FE79}' then '42'
	when "public"."TBL_ACTIVITY"."CREATEUSERID" = '{18A47D85-C869-4F23-836E-E96C925D1C55}' then '38'
	else "public"."TBL_ACTIVITY"."CREATEUSERID"
end as user
FROM
"public"."TBL_ACTIVITY"
Inner Join "public"."TBL_ACTIVITYTYPE" ON "public"."TBL_ACTIVITYTYPE"."ACTIVITYTYPEID" = "public"."TBL_ACTIVITY"."ACTIVITYTYPEID"
WHERE
"public"."TBL_ACTIVITY"."ISDELETED" =  'f' AND
"public"."TBL_ACTIVITYTYPE"."NAME" =  'Meeting' and 
"public"."TBL_ACTIVITY"."CREATEUSERID" in (select "USERID" from "TBL_USER") and 
"public"."TBL_ACTIVITY"."CREATEUSERID" <> '{684BA900-7AA0-4355-97FA-D9EF5E61D481}' and 
"public"."TBL_ACTIVITY"."CREATEUSERID" <> '{59CE144C-318D-4004-B6AA-212376C491C9}'
)
